
{% extends 'base.html' %}
{% block title %}Products - Fashion Store{% endblock %}

{% block content %}
<section class="section-hero overlay inner-page bg-image"
  style="background-image: url(/static/images/bg.jpg);" id="home-section">
  <div class="container">
    <div class="row">
      <div class="col-md-7">
        <h1 class="text-white font-weight-bold">{{ job.title }}</h1>
        <div class="custom-breadcrumbs">
          <a href="{% url 'jobapp:home' %}">Home</a> <span class="mx-2 slash">/</span>
          <a href="{% url 'jobapp:product_list' %}">Products</a> <span class="mx-2 slash">/</span>
          <span class="text-white"><strong>{{ job.title }}</strong></span>
        </div>
      </div>
    </div>
  </div>
</section>
<div class="min-h-screen px-4 sm:px-6 lg:px-8 py-8">

    <!-- Header -->
    <div class="text-center mb-8">
        <h1 class="text-3xl font-bold mt-10 ">Fashion Collection</h1>
        <p class="mt-2 text-lg">Curated styles for the modern wardrobe</p>
    </div>

    <!-- Search Form -->
    <div class="mb-6">
        <form method="GET" class="flex flex-col sm:flex-row gap-2">
            <div class="flex-grow">
                {{ search_form.search }}
            </div>
            <button type="submit" class="px-4 py-2 border rounded">Search</button>

            {% for field in filter_form %}
                {% if field.value %}
                    <input type="hidden" name="{{ field.name }}" value="{{ field.value }}">
                {% endif %}
            {% endfor %}
        </form>
    </div>

    <!-- 3 Column Layout -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

        <!-- Column 1: Filters -->
        <aside class="border rounded p-4">
            <h3 class="text-lg font-semibold mb-4">Filters</h3>
            <form method="GET" id="filterForm" class="space-y-4">
                {% if search_form.search.value %}
                    <input type="hidden" name="search" value="{{ search_form.search.value }}">
                {% endif %}

                <div>
                    <label class="block text-sm font-medium">Category</label>
                    {{ filter_form.category }}
                </div>

                <div>
                    <label class="block text-sm font-medium">Brand</label>
                    {{ filter_form.brand }}
                </div>

                <div>
                    <label class="block text-sm font-medium">Price Range</label>
                    {{ filter_form.price_range }}
                </div>

                <div>
                    <label class="block text-sm font-medium">Size</label>
                    {{ filter_form.sizes }}
                </div>

                <div>
                    <label class="block text-sm font-medium">Color</label>
                    {{ filter_form.colors }}
                </div>

                <div>
                    <label class="block text-sm font-medium">Sort By</label>
                    {{ filter_form.sort_by }}
                </div>

                <div class="flex gap-2 pt-4">
                    <button type="submit" class="flex-1 px-4 py-2 border rounded">Apply</button>
                    <a href="{% url 'jobapp:product_list' %}" class="flex-1 px-4 py-2 border rounded text-center">Clear</a>
                </div>
            </form>
        </aside>

        <!-- Column 2 & 3: Products -->
        <!-- Products using Flexbox -->
        <div class="lg:col-span-2">
            <div class="flex flex-wrap gap-4">
                {% for product in products %}
                    <div class="border rounded overflow-hidden flex flex-col w-48 h-80">

                        <!-- Fixed Small Image -->
                        <div class="relative w-full h-28 flex items-center justify-center bg-gray-50">
                            <img src="{{ product.image.url }}" 
                                 alt="{{ product.name }}" 
                                 class="w-32 h-24 object-cover mx-auto">

                            <!-- Badges -->
                            <div class="absolute top-1 left-1 flex gap-1">
                                {% if product.is_on_sale %}
                                    <span class="px-1 py-0.5 text-xs border rounded text-xs">Sale</span>
                                {% endif %}
                                {% if product.is_featured %}
                                    <span class="px-1 py-0.5 text-xs border rounded text-xs">Featured</span>
                                {% endif %}
                            </div>

                            <!-- Wishlist Button -->
                            <div class="absolute top-1 right-1">
                                <button class="px-1 py-0.5 border rounded text-sm">â™¡</button>
                            </div>
                        </div>

                        <!-- Compact Text Area -->
                        <div class="p-2 flex flex-col flex-grow text-xs">
                            <p class="text-xs text-gray-600 mb-1">{{ product.brand.name }}</p>
                            <h3 class="font-semibold text-xs truncate mb-1">{{ product.name }}</h3>
                            <p class="text-xs line-clamp-2 flex-grow mb-2">{{ product.description|truncatewords:5 }}</p>

                            <div class="mb-1 flex flex-col gap-1 text-xs">
                                <span class="truncate">{{ product.get_sizes_display }}</span>
                                <span class="flex items-center gap-1">
                                    <span class="inline-block w-2 h-2 rounded-full border" style="background-color: {{ product.colors }};"></span>
                                    <span class="truncate">{{ product.get_colors_display }}</span>
                                </span>
                            </div>

                            <div class="mb-1 flex items-center gap-1">
                                <span class="font-bold text-xs">${{ product.get_price }}</span>
                                {% if product.is_on_sale %}
                                    <span class="line-through text-xs text-gray-500">${{ product.price }}</span>
                                {% endif %}
                            </div>

                            <div class="mb-2 text-xs">
                                {% if product.stock_quantity > 0 %}
                                    <span class="text-green-600">In Stock</span>
                                {% else %}
                                    <span class="text-red-600">Out of Stock</span>
                                {% endif %}
                            </div>

                            <div class="flex flex-col gap-1">
                                {% if product.stock_quantity > 0 %}
                                    <button class="w-full px-1 py-1 border rounded text-xs">Add to Cart</button>
                                    <button class="w-full px-1 py-1 border rounded text-xs">Buy Now</button>
                                {% else %}
                                    <button class="w-full px-1 py-1 border rounded text-xs opacity-50 cursor-not-allowed">Out of Stock</button>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>

    </div>
</div>
{% endblock %}